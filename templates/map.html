{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="http://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
        <script src="http://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
        <script src="{% static 'L.KML.js'%}"></script>
    </head>
    <body>
        <div style="width: 100vw; height: 100vh" id="map"></div>
        <script type="text/javascript">
            // Make basemap
            const map = new L.Map('map', { center: new L.LatLng(36.6301208, -4.497461), zoom: 11 });
            const osm = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');

            map.addLayer(osm);

            function onEachFeature(feature, layer) {
                // does this feature have a property named popupContent?
                var co2;

                if (feature.properties) {

                    layer.bindPopup(
                        "<strong>id_app: </strong> " + feature.properties.id_app + "<br/>" +
                        "<strong>session: </strong> " + feature.properties.session + "<br/>" +
                        "<strong>Speed(GPS): </strong>" + feature.properties.speed_GPS + "<br/>" +
                        "<strong>CO₂ in g/km (Average): </strong>" + feature.properties.CO2_Average + "<br/>" +
                        "<strong>CO₂ in g/km (Instantaneous): </strong> " + feature.properties.CO2_Instantaneous + "<br/>" +
                        "<strong>Litres Per 100 Kilometer: </strong> " + feature.properties.Litres_Per_100_Kilometer
                    );

                }
            }
            L.geoJSON({{ data|safe }}, {
                onEachFeature: onEachFeature
            }).addTo(map);

            // var sessions = L.layerGroup([]);

            // sessions.addTo(map)
            // map.addLayer(sessions)

        </script>
    </body>
</html>