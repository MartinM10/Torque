{% extends 'main.html' %}

{% load static %}

{% block html_to_pdf %}
    <div class="row" style="margin-top: 10px">
        <div class="col text-center">
            <a class="btn btn-primary" href="{% url 'export-pdf' filename %}" role="button">
                Descargar PDF</a>
        </div>
    </div>

    {% if moreImportantFeatures %}
        <div class="container-fluid" style="width: 100%; margin-top: 10px;  text-align: center">

            <h2>More important features for principal components</h2>
            <p>The most contributory features for each principal component. Each value represents the percentage of the
                coeficient for the given feature. It corresponds to the first coeficient percetanges that their sum is
                equal
                or greater to 90%</p>
            {% for pca, dict in moreImportantFeatures.items %}
                <ul style="padding: 0">
                    <strong>Principal Component {{ pca }}</strong><br>
                    {% for sensor, value in dict.items %}
                        <li style="list-style: none; font-size: 12px">{{ sensor }}: {{ value|floatformat:2 }}%</li>
                    {% endfor %}
                </ul>
            {% endfor %}
        </div>
    {% endif %}

    {% if explainedVarianceRatio %}
        <div class="container-fluid" style="width: 100%; margin-top: 10px;  text-align: center">

            <h2>Explained variance ratio</h2>
            <p>How much information (variance) corresponds to each of the Principal Components</p>
            {% for variance in explainedVarianceRatio %}
                <strong>Principal Component {{ forloop.counter|add:"-1" }}</strong>
                <p style="font-size: 12px">{{ variance|floatformat:2 }}%</p>
            {% endfor %}

        </div>
    {% endif %}

    <div class="container-fluid" style="width: 100%; margin-top: 10px;  text-align: center">

        <div class="card" style="width: 100%">
            <img class="card-img" src="data:image/png;base64,{{ cumulativeExplainedVarianceRatioPlot }}" alt=""
                 style="width: 40%; height: auto">
            <div class="card-body">
                <p class="card-text">Amount of variance (y axis) depending on the number of components</p>
            </div>
        </div>
        <br>
        <div class="card" style="width: 100%">
            <img class="card-img-top" src="data:image/png;base64,{{ wcssPlot }}" alt=""
                 style="width: 40%; height: auto">
            <div class="card-body">
                <p class="card-text"> Within Cluster Sum of Squares (WCSS) measures the squared average distance of all
                    the points within a cluster to the cluster centroid</p>
            </div>
        </div>
        <br>
        <div class="card" style="width: 100%">
            <img class="card-img" src="data:image/png;base64,{{ twoFirstComponentsPlot }}" alt=""
                 style="width: 40%; height: auto">
            <div class="card-body">
                <p class="card-text">Two Principal Components plot by clusters</p>
            </div>
        </div>
        <br>
        <div class="card" style="width: 100%">
            <img class="card-img-overlay" src="data:image/png;base64,{{ componentsAndFeaturesPlot }}" alt=""
                 style="width: 70%; height: auto">
            <div class="card-body">
                <p class="card-text">Chart about how the features affect each component</p>
            </div>
        </div>
        <br>
        <div class="card" style="width: 100%">
            <img class="card-img" src="data:image/png;base64,{{ svmPlot }}" alt="" style="width: 40%; height: auto">
            <div class="card-body">
                <p class="card-text">Two Principal Components plot by categories</p>
            </div>
        </div>
        <br>
    </div>
{% endblock html_to_pdf %}